<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="ex">

	<!-- 완료 -->
	<select id="find01" parameterType="myMap" resultType="int">	<!-- 교수 -->
		/*ex.find01*/
		SELECT
			COUNT(1)
		FROM
			CPS.FIELD_PRACTICAL_USER T1
		WHERE
			USER_SANGTAE IN ('재직')
			AND USR_GROUP IN('겸임교수', '전임교수')
	</select>

	<!-- 완료 -->
	<select id="find02" parameterType="myMap" resultType="myCamelMap">		<!-- 교수 -->
		/*ex.find02*/
		SELECT
			*
		FROM(
		    SELECT
		      	ROWNUM PAGE, A1.*
			FROM(
				SELECT
					USER_SABEON AS INHAID,						/*사번*/
					HJ_SEX AS KSEX,								/*성별*/
					USER_NAME AS KNAME,							/*이름*/
					'' AS EMAIL,								/*이메일*/
					'' AS PCS_PHONE,							/*핸드폰*/
					'' AS TEL,									/*전화번호*/
					HJ_HAKGWA_CODE AS MAJOR_CODE,				/*학과코드*/
					(SELECT KNAME FROM CPS.VIEW_HAKGWA_HAKSA WHERE CODE = A.HJ_HAKGWA_CODE) AS KMAJOR,			/*학과명*/
					HJ_HAKGWA_CODE AS DEPT_CODE,																/*학과코드*/
					(SELECT KNAME FROM CPS.VIEW_HAKGWA_HAKSA WHERE CODE = A.HJ_HAKGWA_CODE) AS KDEPT			/*학과명*/
				FROM
					CPS.FIELD_PRACTICAL_USER A
				WHERE
					USER_SANGTAE IN ('재직')
					AND USR_GROUP IN('겸임교수', '전임교수')
					<if test='searchVal != null and searchVal != ""'>
					AND USER_NAME LIKE '%'||#{searchVal, jdbcType=VARCHAR}||'%'
					</if>
		  			) A1 WHERE 1=1
				<if test='session.mberGroup=="5"'>
					AND MAJOR_CODE=#{session.mberMajor, jdbcType=VARCHAR}
				</if>
				<if test="@syworks.lib.mybatis.Util@isNotEmpty(profId)">
					AND INHAID = #{profId, jdbcType=VARCHAR}
				</if>
		     	) T1
		<if test="@syworks.lib.mybatis.Util@isNotEmpty(paginationInfo)">
		WHERE
			PAGE BETWEEN #{paginationInfo.firstRecordIndex}+1 AND #{paginationInfo.firstRecordIndex} + #{paginationInfo.recordCountPerPage}
		</if>
	</select>

	<!-- 완료 -->
	<select id="find03" parameterType="myMap" resultType="int">	<!--  학과 view -->
		/*ex.find03*/
		SELECT
			COUNT(1)
		FROM
			CPS.VIEW_HAKGWA_HAKSA T1
	</select>

	<!-- 완료 -->
	<select id="find04" parameterType="myMap" resultType="myCamelMap">		<!--  학과 view -->
		/*ex.find04*/
		SELECT
			*
		FROM(
			SELECT
				ROWNUM RNUM
				,'0000' AS DEPT_CODE
				,'관광대학교' AS DEPT_KNAME
				,CODE AS MAJOR_CODE
				,KNAME AS MAJOR_KNAME
			FROM
				CPS.VIEW_HAKGWA_HAKSA T1
		)
		<if test="@syworks.lib.mybatis.Util@isNotEmpty(paginationInfo)">
		WHERE
			RNUM BETWEEN #{paginationInfo.firstRecordIndex}+1 AND #{paginationInfo.firstRecordIndex} + #{paginationInfo.recordCountPerPage}
		</if>
	</select>

	<!-- 완료 -->
	<select id="find05" parameterType="myMap" resultType="myCamelMap">		<!-- 학생 -->
		/*ex.find05*/
		<![CDATA[
		SELECT
			USER_HAKBEON ST_SEQ, 		/* 학번 */
			USER_HAKBEON ST_NUM, 		/* 학번 */
			HJ_SEX ST_SEX,				/* 성별 */
			USER_NAME ST_NAME,			/* 이름 */
			'' ST_EMAIL,				/* 이메일 */
			'' ST_HP,					/* 핸드폰번호 */
			'' ST_TEL,					/* 전화번호 */
			HJ_HAKGWA_CODE ST_MAJOR,	/* 전공코드 */
			'' ST_MAJOR_STR,			/* 전공명 */
			'' SUB_KMAJORS,				/* 복수전공,부전공 */
			HJ_HAKNYEON ST_GRADE,		/* 학년 */
			HJ_SANGIL ST_BIRTH,			/* 생일 */
			'' ST_BIRTH,				/* 나이 */
			'' ST_ZIPCODE,				/* 우편번호 */
			'' ST_ADDR1,				/* 주소 */
			'' ST_TOT_CREDIT,			/* 이수학점 */
			'' ST_MARK,					/* 평점 */
			HJ_ISU_HAKGISU ST_TERM,		/* 이수학기 */
			'' ST_LINC_YN,				/*  */
			JIDO_GYOSU PROF_ID,			/* 지도교수ID */
			GYOSU_KNAME PROF_NAME,		/* 지도교수 */
		 	USER_SANGTAE AS SHREG_NM 	/* 학적상태 */
		FROM
			CPS.FIELD_PRACTICAL_USER
		WHERE
			USER_HAKBEON = #{id, jdbcType=VARCHAR}
			AND USER_SANGTAE IN ('재학','휴학')
			AND USR_GROUP IN('학부재학생', '학부휴학생')
			AND HJ_ISU_HAKGISU != 0
			AND HJ_ISU_HAKGISU IS NOT NULL
		]]>
	</select>

	<!-- 완료 -->
	<select id="find06" parameterType="myMap" resultType="myCamelMap">	    <!-- 교수 -->
		SELECT
			USER_SABEON AS INHAID,
		    HJ_SEX AS KSEX,
			USER_NAME AS KNAME,
			'' AS EMAIL,
			'' AS PCS_PHONE,
			'' AS TEL,
			HJ_HAKGWA_CODE AS MAJOR_CODE,
			(SELECT KNAME FROM CPS.VIEW_HAKGWA_HAKSA WHERE CODE = A.HJ_HAKGWA_CODE) AS KMAJOR,
			HJ_HAKGWA_CODE AS DEPT_CODE,
		    (SELECT KNAME FROM CPS.VIEW_HAKGWA_HAKSA WHERE CODE = A.HJ_HAKGWA_CODE) AS KDEPT
		FROM
			CPS.FIELD_PRACTICAL_USER A
		WHERE
			USER_SANGTAE IN ('재직')
			AND USR_GROUP IN('겸임교수', '전임교수')
			AND USER_SABEON = #{id, jdbcType=VARCHAR}
	</select>

	<!-- 완료 -->
	<select id="find07" parameterType="myMap" resultType="myCamelMap">		<!-- 직원 -->
		SELECT
			*
		FROM
			CPS.FIELD_PRACTICAL_USER
		WHERE
			USER_SABEON = #{id, jdbcType=VARCHAR}
			AND USR_GROUP = '직원'
	</select>


	<select id="find08" parameterType="myMap" resultType="myCamelMap">	    <!-- 수강신청 정보 -->
		SELECT
			SUBJECT_NAME SUBJECT,
			SUBJECT_TYPE CREDIT_GBN,
			TERM_NM REQ_SEASON ,
			CREDIT REQ_CREDIT')
		FROM
			EX_SUBJECT_VU
		WHERE
			STNO = #{session.mberId}
				<!--
				AND YEAR = #{jsYear}
				AND TERM_NM = #{internSeasonCodeStr}
				 -->
	</select>

	<!-- 완료 -->
	<select id="find09" parameterType="myMap" resultType="myCamelMap">		<!-- 조교 -->
		SELECT
			USER_SABEON AS INHAID,
		    HJ_SEX AS KSEX,
		    USER_NAME AS KNAME,
		    '' AS EMAIL,
		    '' AS PCS_PHONE,
		    '' AS TEL,
		    HJ_HAKGWA_CODE AS MAJOR_CODE,
		    (SELECT KNAME FROM CPS.VIEW_HAKGWA_HAKSA WHERE CODE = A.HJ_HAKGWA_CODE) AS KMAJOR,
		    HJ_HAKGWA_CODE AS DEPT_CODE,
		    (SELECT KNAME FROM CPS.VIEW_HAKGWA_HAKSA WHERE CODE = A.HJ_HAKGWA_CODE) AS KDEPT
		 FROM
			CPS.FIELD_PRACTICAL_USER A
		 WHERE
			USER_SANGTAE IN ('재직')
			AND USR_GROUP = '조교'
			AND USER_SABEON = #{id, jdbcType=VARCHAR}
	</select>

	<!-- 완료 -->
	<select id="find10" parameterType="myMap" resultType="myCamelMap">		<!-- 학생 로그인 -->
		SELECT
			USER_HAKBEON
		FROM
			CPS.FIELD_PRACTICAL_USER
		WHERE
			USER_ID = #{id}
		  	AND USER_PASSWORD = #{pw}
		  	AND USER_SANGTAE IN ('재학','휴학')
			AND USR_GROUP IN('학부재학생', '학부휴학생')
			AND HJ_ISU_HAKGISU != 0
			AND HJ_ISU_HAKGISU IS NOT NULL
	</select>
	<select id="find11" parameterType="myMap" resultType="myCamelMap">		<!-- 교직원 로그인 -->
		SELECT
			USER_SABEON
		FROM
			CPS.FIELD_PRACTICAL_USER
		WHERE
			USER_ID = #{id}
		  	AND USER_PASSWORD = #{pw}
		  	AND USER_SANGTAE IN ('재직')
			AND USR_GROUP IN('겸임교수', '전임교수','직원', '조교')
	</select>
</mapper>
